---
import { getCollection } from 'astro:content';

// 获取文章集合
const posts = await getCollection('posts'); // 确保你的文章集合名是 posts

// 统计文章数
const postCount = posts.length;

// 统计标签和分类
const tags = new Set();
const categories = new Set();
let totalWords = 0;

posts.forEach(post => {
  if (post.data.tags) post.data.tags.forEach(tag => tags.add(tag));
  if (post.data.category) categories.add(post.data.category);
  if (post.body) totalWords += post.body.split(/\s+/).length;
});

const totalWordsInWan = (totalWords / 10000).toFixed(1);
---

<div class="blog-stats">
  <h3>📊 Blog Stats</h3>
  <ul>
    <li>📝 Articles: {postCount}</li>
    <li>🏷 Tags: {tags.size}</li>
    <li>📂 Categories: {categories.size}</li>
    <li>✍️ Total Words: {totalWordsInWan}万</li>
  </ul>
</div>

<style>
.blog-stats {
  margin-top: 1rem;
  padding: 1rem;
  background-color: rgba(0,0,0,0.05);
  border-radius: 8px;
}
.blog-stats h3 {
  margin-bottom: 0.5rem;
  font-size: 1.1rem;
}
.blog-stats ul {
  list-style: none;
  padding: 0;
  margin: 0;
}
.blog-stats li {
  margin: 0.3rem 0;
  font-size: 0.95rem;
}
</style>