---
import { getCollection } from 'astro:content';

const posts = await getCollection('posts');

const postCount = posts.length;
const tags = new Set();
const categories = new Set();
let totalWords = 0;

posts.forEach(post => {
  if (post.data.tags) post.data.tags.forEach(tag => tags.add(tag));
  if (post.data.category) categories.add(post.data.category);
  if (post.body) totalWords += post.body.split(/\s+/).length;
});

const totalWordsInWan = (totalWords / 10000).toFixed(1);
---

<div class="grid grid-cols-2 gap-4 mt-4 sm:grid-cols-2">
  <div class="flex items-center bg-gray-100 dark:bg-[#1e1e2e] p-3 rounded-lg shadow-sm hover:shadow-md transition-all duration-200">
    <div class="text-2xl mr-3">📝</div>
    <div>
      <div class="text-sm text-gray-600 dark:text-gray-400">文章数</div>
      <div class="text-lg font-semibold text-gray-900 dark:text-gray-100">{postCount}</div>
    </div>
  </div>

  <div class="flex items-center bg-gray-100 dark:bg-[#1e1e2e] p-3 rounded-lg shadow-sm hover:shadow-md transition-all duration-200">
    <div class="text-2xl mr-3">🏷</div>
    <div>
      <div class="text-sm text-gray-600 dark:text-gray-400">标签数</div>
      <div class="text-lg font-semibold text-gray-900 dark:text-gray-100">{tags.size}</div>
    </div>
  </div>

  <div class="flex items-center bg-gray-100 dark:bg-[#1e1e2e] p-3 rounded-lg shadow-sm hover:shadow-md transition-all duration-200">
    <div class="text-2xl mr-3">📂</div>
    <div>
      <div class="text-sm text-gray-600 dark:text-gray-400">分类数</div>
      <div class="text-lg font-semibold text-gray-900 dark:text-gray-100">{categories.size}</div>
    </div>
  </div>

  <div class="flex items-center bg-gray-100 dark:bg-[#1e1e2e] p-3 rounded-lg shadow-sm hover:shadow-md transition-all duration-200">
    <div class="text-2xl mr-3">✍️</div>
    <div>
      <div class="text-sm text-gray-600 dark:text-gray-400">总字数</div>
      <div class="text-lg font-semibold text-gray-900 dark:text-gray-100">{totalWordsInWan} 万</div>
    </div>
  </div>
</div>